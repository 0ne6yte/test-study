# Week1

## 테스트 왜 해야하는가?

서비스의 품질을 유지하기 위해서

초기에 서비스는 기능도 많지 않고 그에 따른 코드 베이스도 크지 않다. 즉, 테스트하는데 시간이 그렇게 오래걸리지 않는다.

일반적으로 서비스는 계속해서 발전해나간다. 처음에 작았던 서비스도 기능이 추가되고 점점 코드 베이스가 거대해져 간다.
즉, 테스트를 위해 점점 많은 시간을 사용하게 된다. 그로 인해, 점점 서비스를 배포하는데 걸리는 시간은 늘어나게 되고, 유지보수가 힘들어진다.
시간이 지나면 현실적으로 모든 기능을 테스트하기란 힘들어지고, 서비스 품질을 유지하면서 빠르게 배포하는 것은 더더욱 힘들어진다.

이러한 문제를 해결하기 위한 방법중 하나가 바로 **테스트 자동화**이다.

또 테스트를 자동화하기 위한 쉬운 방법 중 하나는 **실행 가능한 형태로 테스트 시나리오를 작성해 테스트 하는 것**이다. 이를 **테스트 코드**라고 한다.

단순히 아래와 같이 작성한 것도 테스트라고 할 수 있다.
```typescript
function add(a: number, b: number): number {
    return a + b;
}

function test1() {
    const a = 1;
    const b = 2;
    
    const result = add(a, b);
    
    if (result !== 3) {
        throw new Error('테스트에 실패했습니다');
    }
}
```

하지만, 이렇게 테스트 코드를 작성하면 테스트 코드를 작성하는데 걸리는 시간이 많아지고, 테스트 실행을 위한 방법도 필요해진다. 
또한, 테스트 코드를 작성하는 것도 코드를 작성하는 것이기 때문에 테스트 코드에 버그가 있을 수 있다.

이러한 문제를 해결하기 위해 **테스트 프레임워크**가 등장했다.

테스트 프레임워크는 테스트 코드를 작성하는데 도움을 주는 도구이다. 
테스트 프레임워크를 사용하면 테스트 코드를 작성하는데 걸리는 시간을 줄일 수 있고, 테스트 코드를 작성하는데 들어가는 비용을 줄일 수 있다.

Node 진영엔 **Jest** 같은 테스트 프레임워크가 있고 Jvm 진영엔 **Junit**, **Kotest** 같은 테스트 프레임워크가 존재한다.

아래는 Jest를 사용한 테스트 코드의 예시이다. 위 test1과 동일하지만 더욱 간단하게 테스트를 작성할 수 있다.
```typescript
test('adds 1 + 2 to equal 3', () => {
  expect(sum(1, 2)).toBe(3);
});
```

### 테스트 코드를 작성해서 얻을 수 있는 이점은 어떤게 있을까?

테스트 코드를 작성하면 위에서 언급했던 것 처럼 테스트를 쉽게 자동화할 수 있고, **빠르게 테스트**가 가능하며 서비스 품질을 높일 수 있다.

또 어떤 이점들이 있을까?

- **심리적 안정감**
  - 그래도 테스트를 통해 검증했으니까... 괜찮겠지 😇🙏🏻
- **빠른 피드백과 지속적인 피드백**
  - 테스트 코드가 없다면 코드를 수정하고 나서 직접 실행해 호출해보기 전까지 코드가 정상적으로 동작하는지 알 수 없다. 하지만 테스트 코드가 있다면 빠르게 현재 작성한 코드가 유효한지 확인할 수 있다.
  - 코드를 수정할 때, 그 코드에 영향도가 어느정도인지 확인하기 위해선 모든 코드를 탐색해봐야한다. 해당 코드들도 정상동작하는지 확인이 필요하다. 테스트 코드를 작성하면 내가 수정한 부분이 다른 부분에 영향을 미치는 지 지속적인 피드백을 받을 수 있다.
- **명세화**
  - 테스트 케이스들을 통해 해당 코드가 어떻게 동작해야하는지 명세화할 수 있고, 각각이 어떤 책임을 가지고 있도록 설계되었는지 미리 볼 수 있다.
- **코드 스멜 파악**
  - 테스트 코드를 작성하다보면 어려움이 느껴질 때가 있다. 너무 많은 케이스를 테스트 해야하거나, 데이터베이스나 다른 서버와 연관되어 테스트를 작성하기 어렵거나 등등. 이러한 스멜을 통해, 현재 테스트하려는 부분이 너무 많은 책임을 가지고 있어 분리할 필요가 있거나, 쉽게 테스트가 가능하도록 분리하는 등 리팩토링의 필요성을 느끼게 될 수 있다.

## 테스트(코드) 어떻게 해야하는가?(단위테스트? 통합테스트?)

### 좋은 테스트의 정의는 무엇일까?

- **빠르다**
  - 위에서 언급했던 것처럼 테스트 코드는 테스트 자동화를 통해 빠른 피드백을 받아야하기 때문에, 빠르게 실행되어야 한다.
  - **빠르게 테스트 하기 위해선 어떤 방법들이 있을까?**
    - 데이터베이스에 실제로 데이터를 적재하고 테스트하거나 실제로 외부 API를 호출해서 테스트해야 한다면 테스트의 속도는 느려질 것 이다.
    - 서버를 띄워서 API를 테스트한다면, 서버를 띄우는데 시간이 걸리고, 서버를 띄운 상태에서 테스트를 실행해야하기 때문에 테스트 속도가 느려질 것이다.
- **반복적으로 실행가능해야하며, 실행결과가 일정해야한다**
- **테스트가 독립적이어야 한다**
- **적절한 책임과 목적에 맞는 테스트가 이루어져야 한다**
- **실서비스와 유사해야한다**
- **테스트 실패 사유가 명확해야한다**
- **구현이 아닌 결과를 검증하자**
- **DAMP(Descriptive And Meaningful Phrases)하게 작성해야 한다**